{% if page.collection == "series" and page.series %}
  {% assign all_in_series = site.series | where: "series", page.series | sort: "series_order" %}
  {% assign total = all_in_series.size %}

  {% if total > 1 %}
    {% assign current_order = page.series_order %}

    {% for post in all_in_series %}
      {% if post.series_order == current_order %}
        {% assign current_index = forloop.index0 %}
      {% endif %}
    {% endfor %}

    {% if current_index > 0 %}
      {% assign prev_index = current_index | minus: 1 %}
      {% assign prev_post = all_in_series[prev_index] %}
    {% endif %}

    {% assign next_index = current_index | plus: 1 %}
    {% if next_index < total %}
      {% assign next_post = all_in_series[next_index] %}
    {% endif %}

    <nav class="series-nav">
      {% if prev_post %}
        <a href="{{ prev_post.url | relative_url }}" class="series-nav__link series-nav__link--prev">
          <span class="series-nav__arrow">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </span>
          <span class="series-nav__text">
            <span class="series-nav__label">이전 글</span>
            <span class="series-nav__title">{{ prev_post.title }}</span>
          </span>
        </a>
      {% endif %}
      {% if next_post %}
        <a href="{{ next_post.url | relative_url }}" class="series-nav__link series-nav__link--next">
          <span class="series-nav__text">
            <span class="series-nav__label">다음 글</span>
            <span class="series-nav__title">{{ next_post.title }}</span>
          </span>
          <span class="series-nav__arrow">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </span>
        </a>
      {% endif %}
    </nav>
  {% endif %}
{% endif %}
